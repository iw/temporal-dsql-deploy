persistence:
  defaultStore: default
  visibilityStore: esdefault
  advancedVisibilityStore: esdefault
  numHistoryShards: $TEMPORAL_HISTORY_SHARDS
  datastores:
    default:
      sql:
        pluginName: $TEMPORAL_SQL_PLUGIN_NAME
        databaseName: $TEMPORAL_SQL_DATABASE
        connectAddr: $TEMPORAL_SQL_HOST:$TEMPORAL_SQL_PORT
        connectProtocol: tcp
        user: $TEMPORAL_SQL_USER
        # For IAM auth, this might be empty or contain a token
        passwordFile: $TEMPORAL_SQL_PASSWORD_FILE
        maxConns: $TEMPORAL_SQL_MAX_CONNS
        maxIdleConns: $TEMPORAL_SQL_MAX_IDLE_CONNS
        # DSQL-specific configuration
        dsqlConfig:
          clusterArn: $TEMPORAL_DSQL_CLUSTER_ARN
          region: $TEMPORAL_SQL_REGION
          iamAuth: $TEMPORAL_SQL_IAM_AUTH
          tokenRefreshInterval: $TEMPORAL_SQL_TOKEN_REFRESH_INTERVAL
        tls:
          enabled: $TEMPORAL_SQL_TLS_ENABLED
          caFile: $TEMPORAL_SQL_CA_FILE
          serverName: $TEMPORAL_SQL_SERVER_NAME
          # DSQL-specific TLS settings
          skipVerify: $TEMPORAL_SQL_TLS_SKIP_VERIFY
          enableHostVerification: $TEMPORAL_SQL_TLS_ENABLE_HOST_VERIFICATION
    esdefault:
      elasticsearch:
        version: v8
        url: $TEMPORAL_OPENSEARCH_ENDPOINT
        username: $TEMPORAL_OPENSEARCH_USER
        passwordFile: $TEMPORAL_OPENSEARCH_PASSWORD_FILE
        disableSniff: true
        logLevel: error